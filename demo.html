<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NASAzureFileSyncronizer Documentation</title>
</head>
<body>
    <h1>NASAzureFileSyncronizer (Sync NAS(OnPrem) to Jump Server to Azure Cloud)</h1>

    <h2>1.1 Assumption & Limitation</h2>
    <ul>
        <li>Between OnPrem Jump Server to NAS, Robocopy is in place without /MIR i.e., copy-paste is happening between those endpoints, due to which anything deleted from Azure File Share will never be deleted from NAS.</li>
        <li>Intentional & Adjustable Delay has been added between Azure File Share to OnPrem Jump Server to avoid any potential data/file loss.</li>
        <li>Below diagram is the logical plan of the solution:</li>
    </ul>
    <img src="./images/project1/Picture1.png" alt="Logical Plan of the Solution">

    <h4>Consideration on the Solution provided:</h4>
    <ol>
        <li>Azure Storage Sync Service will take care of syncing from Windows Server (On Prem) to Azure file share by services, so we have not added any code in the main script to handle that.</li>
        <li>CSV will be the only input file to the main script.</li>
        <li>For multiple NAS connections, please add input files to the main script. Based on that, the task scheduler frequency to run should be around every 10 minutes.</li>
        <li>A mechanism has been added to capture logs on a specific path which will be shared in the SOP document.</li>
    </ol>

    <h2>1.2 Step 1 - Provide Input using CSV file [One Time Activity]</h2>
    <ol>
        <li>
            Download the Tool Zip Package 
            (<a href="https://github.com/mohitmsingh/automation-script/blob/main/powershell/NASAzureFileSyncronizer/NASAzureFileSyncronizer.zip">link</a>) 
            to a specific Jump Server where we have storage sync service installed onto D: Drive and extract the file there:
            <img src="./images/project1/Picture2.png" alt="Tool Extraction">
        </li>
        <li>
            Navigate to Path <code>D:\NASAzureFileSyncronizer\Script</code>, and copy Input.csv file on your local machine for modification (for better visual on the data):
            <img src="./images/project1/Picture3.png" alt="Navigation">
            <img src="./images/project1/Picture4.png" alt="CSV Example">
        </li>
    </ol>

    <table border="1">
        <thead>
            <tr>
                <th>Header</th>
                <th>Header Value</th>
                <th>Explanation</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>srno</td>
                <td>NAS1, NAS2</td>
                <td>Serial No.</td>
            </tr>
            <tr>
                <td>ennv</td>
                <td>Example: dev, sit, uat, prd</td>
                <td>Environment Name</td>
            </tr>
            <!-- Additional table rows omitted for brevity -->
        </tbody>
    </table>

    <p>Once the changes are made to input.csv, copy back the input file from local machine to OnPrem Path 
        <code>D:\NASAzureFileSyncronizer\Script</code>.
    </p>
    <img src="./images/project1/Picture5.png" alt="Path Verification">

    <h2>1.3 Step 2 - Encrypt Confidential Value [One Time Activity]</h2>
    <ol>
        <li>
            Go to EncryptDecryptTool, on the path where you copied the zip file, navigate to 
            <code>D:\NASAzureFileSyncronizer\EncryptDecryptTool</code> and double-click on “Startup.bat”.
            <img src="./images/project1/Picture6.png" alt="Encryption Tool">
        </li>
        <li>Encrypt the below values to add them in the input.csv file:
            <ul>
                <li>nasMachineUserName</li>
                <li>nasMachinePwd</li>
                <li>CloudEndpointName</li>
            </ul>
        </li>
    </ol>
    <img src="./images/project1/Picture7.png" alt="Encryption Process">

    <h2>1.4 Step 3 – Verify Main PowerShell Script</h2>
    <ol>
        <li>Navigate to <code>D:\NASAzureFileSyncronizer\Script\NASAzureFileSyncronizer.ps1</code>.
            <img src="./images/project1/Picture8.png" alt="Script Verification">
        </li>
    </ol>

    <h2>1.5 Step 4 – Create & Configure Task Scheduler</h2>
    <ol>
        <li>Open “Task Scheduler” --> Click on Import Task.</li>
        <li>Navigate to path: <code>D:\NASAzureFileSyncronizer\Script\TaskScheduler</code> and import <code>NASAzureFileSyncronizer.xml</code> to create and configure the task Scheduler.</li>
    </ol>
    <img src="./images/project1/Picture10.png" alt="Task Scheduler">

    <h2>1.6 Step 5 – Logging</h2>
    <p>
        Logs are generated here for every run: 
        <code>D:\NASAzureFileSyncronizer\Script\Logs</code>. 
        Housekeeping policy keeps the last 5 days’ logs only.
    </p>
    <img src="./images/project1/Picture13.png" alt="Logging">
</body>
</html>
